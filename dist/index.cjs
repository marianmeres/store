"use strict";const e=e=>"function"==typeof e,r=(r,t="")=>{Array.isArray(r)||(r=[r]),r.forEach((r=>{if(!e(r))throw new TypeError(`${t} Expecting function type`.trim())}))},t=r=>e(r.subscribe)&&e(r.get),s=(t,{persist:s}={persist:null})=>{let c=(()=>{const e=new Map,r=r=>(e.has(r)||e.set(r,new Set),e.get(r)),t=(e,t)=>{if("function"!=typeof t)throw new TypeError("Expecting callback function as second argument");return r(e).add(t),()=>r(e).delete(t)};return{publish:(e,t={})=>{r(e).forEach((e=>e(t)))},subscribe:t,subscribeOnce:(e,r)=>{const s=t(e,(e=>{r(e),s()}));return s},unsubscribeAll:r=>e.delete(r)}})(),n=t;const i=r=>{n!==r&&(n=r,e(s)&&s(n),c.publish("change",n))},o=()=>n;return{set:i,get:o,update:e=>{r(e,"[createStore.update]"),i(e(o()))},subscribe:(e,t=!1)=>(r(e,"[createStore.subscribe]"),t&&e(n),c.subscribe("change",e)),subscribeOnce:e=>(r(e,"[createStore.subscribeOnce]"),c.subscribeOnce("change",e))}};exports.createDerivedStore=(e,c)=>{const n=s(void 0),i=[];e.forEach((e=>{if(!t(e))throw new TypeError("Expecting array of StoreLike objects");i.push(e.get())}));let o=!1;e.forEach(((e,r)=>{e.subscribe((e=>{i[r]=e,n.set(c(i)),o=!0}))}));const{get:b,subscribeOnce:u}=n;return{get:b,subscribe:(e,t=!1)=>(r(e,"[createDerivedStore.subscribe]"),t&&!o&&(n.set(c(i)),o=!0),n.subscribe(e,t)),subscribeOnce:u}},exports.createStore=s,exports.isStoreLike=t;
